<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.baofu.international.global.account.core.dal.mapper.UserBankCardInfoMapper">
    <resultMap id="BaseResultMap" type="com.baofu.international.global.account.core.dal.model.UserBankCardInfoDo">
        <id column="ID" jdbcType="BIGINT" property="id"/>
        <result column="USER_NO" jdbcType="BIGINT" property="userNo"/>
        <result column="RECORD_NO" jdbcType="BIGINT" property="recordNo"/>
        <result column="ACC_TYPE" jdbcType="TINYINT" property="accType"/>
        <result column="CARD_HOLDER" jdbcType="VARCHAR" property="cardHolder"/>
        <result column="CARD_NO" jdbcType="VARCHAR" property="cardNo"/>
        <result column="BANK_NAME" jdbcType="VARCHAR" property="bankName"/>
        <result column="CARD_TYPE" jdbcType="TINYINT" property="cardType"/>
        <result column="STATE" jdbcType="TINYINT" property="state"/>
        <result column="BANK_CODE" jdbcType="VARCHAR" property="bankCode"/>
        <result column="REMARKS" jdbcType="VARCHAR" property="remarks"/>
        <result column="CREATE_AT" jdbcType="TIMESTAMP" property="createAt"/>
        <result column="CREATE_BY" jdbcType="VARCHAR" property="createBy"/>
        <result column="UPDATE_BY" jdbcType="VARCHAR" property="updateBy"/>
        <result column="UPDATE_AT" jdbcType="TIMESTAMP" property="updateAt"/>
        <result column="BANK_BRANCH_NAME" jdbcType="VARCHAR" property="bankBranchName"/>
    </resultMap>
    <sql id="Base_Column_List">
        ID,
        USER_NO,
        RECORD_NO,
        ACC_TYPE,
        CARD_HOLDER,
        CARD_NO,
        BANK_NAME,
        CARD_TYPE,
        STATE,
        BANK_CODE,
        REMARKS,
        CREATE_AT,
        CREATE_BY,
        UPDATE_BY,
        UPDATE_AT,
        BANK_BRANCH_NAME
    </sql>

    <insert id="insert" parameterType="com.baofu.international.global.account.core.dal.model.UserBankCardInfoDo">
        insert into T_USER_BANK_CARD_INFO (
        USER_NO,
        RECORD_NO,
        ACC_TYPE,
        CARD_HOLDER,
        CARD_NO,
        BANK_NAME,
        CARD_TYPE,
        STATE,
        BANK_CODE,
        REMARKS,
        CREATE_AT,
        CREATE_BY,
        UPDATE_BY,
        UPDATE_AT,
        BANK_BRANCH_NAME)
        values (
        #{userNo,jdbcType=BIGINT},
        #{recordNo,jdbcType=BIGINT},
        #{accType,jdbcType=TINYINT},
        #{cardHolder,jdbcType=VARCHAR},
        #{cardNo,jdbcType=VARCHAR},
        #{bankName,jdbcType=VARCHAR},
        #{cardType,jdbcType=TINYINT},
        #{state,jdbcType=TINYINT},
        #{bankCode,jdbcType=VARCHAR},
        #{remarks,jdbcType=VARCHAR},
        NOW(),
        #{createBy,jdbcType=VARCHAR},
        #{updateBy,jdbcType=VARCHAR},
        NOW(),
        #{bankBranchName,jdbcType=VARCHAR})
    </insert>

    <select id="selectUserBankCardByUserNo" resultMap="BaseResultMap">
        /**UserBankCardInfoMapper.selectUserBankCardByUserNo*/
        SELECT
        <include refid="Base_Column_List"/>
        FROM
        T_USER_BANK_CARD_INFO
        WHERE
        USER_NO=#{userNo}
        AND
        STATE!=3
        order by CREATE_AT desc
    </select>

    <select id="selectUserBankCardNo" resultMap="BaseResultMap">
        /**UserBankCardInfoMapper.selectUserBankCardNo*/
        SELECT
        <include refid="Base_Column_List"/>
        FROM
          T_USER_BANK_CARD_INFO
        WHERE
        USER_NO=#{userNo ,jdbcType=BIGINT}
        AND
        RECORD_NO=#{recordNo ,jdbcType=BIGINT}
    </select>

    <update id="delByUserBankCardNo">
        /*UserBankCardInfoMapper.delByUserBankCardNo*/
        UPDATE
          T_USER_BANK_CARD_INFO
        SET
          STATE = 3,
          UPDATE_AT = NOW()
        WHERE
          USER_NO=#{userNo ,jdbcType=BIGINT}
        AND
          RECORD_NO=#{recordNo ,jdbcType=BIGINT}
    </update>

    <update id="updateBankCartState">
        UPDATE
        T_USER_BANK_CARD_INFO
        SET
        STATE = #{state,jdbcType=TINYINT},
        UPDATE_AT = NOW(),
        UPDATE_BY = #{updateBy,jdbcType=VARCHAR}
        WHERE
        USER_NO=#{userNo ,jdbcType=BIGINT}
        AND
        STATE= 1
    </update>

</mapper>